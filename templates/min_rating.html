{% extends 'template.html' %}
{% block content %}
        <section>
            <h2>Filter by Minimum Rating</h2>
            <form id="min-rating-form">
                <label for="min_rating">Minimum Rating:</label>
                <input type="number" id="min_rating" name="min_rating" step="0.1" min="0" max="10">
                <button type="submit">Apply Filter</button>
            </form>
        </section>
        <section>
            <h2>Filtered Restaurants</h2>
            <ul id="restaurants-list" class="no-list column">
                <!-- This will be populated by JavaScript -->
            </ul>
        </section>
{% endblock %} 
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('min-rating-form');
            const restaurantsList = document.getElementById('restaurants-list');

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                fetchRestaurantsWithMinRating();
            });

            function fetchRestaurantsWithMinRating() {
                const minRating = document.getElementById('min_rating').value;
                const fetchURL = `/restaurants_with_min_rating?min_rating=${minRating}`;

                fetch(fetchURL)
                    .then(response => response.json())
                    .then(data => {
                        renderRestaurants(data);
                    })
                    .catch(error => console.error('Error fetching data:', error));
            }

            function renderRestaurants(restaurants) {
                restaurantsList.innerHTML = '';
                if (restaurants.length > 0) {
                    restaurants.forEach(restaurant => {
                        const li = document.createElement('li');
                        li.className = 'restaurant';
                        li.innerHTML = `
                            <h3>${restaurant.name}</h3>
                            <p><strong>Rating:</strong> ${restaurant.rating}</p>
                            <p><strong>Location:</strong> ${restaurant.location}</p>
                            <p><strong>Cuisine:</strong> ${restaurant.cuisine}</p>
                        `;
                        restaurantsList.appendChild(li);
                    });
                } else {
                    const li = document.createElement('li');
                    li.textContent = 'No restaurants found with the specified minimum rating.';
                    restaurantsList.appendChild(li);
                }
            }
        });
    </script>
</body>
</html>
